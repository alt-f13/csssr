"use strict";angular.module("csssrApp",["ngRoute","angular-loading-bar","angucomplete-alt","hc.marked"]).config(["$routeProvider","cfpLoadingBarProvider",function(a,b){a.when("/:user?",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/:user/:repo/issuse/:id",{templateUrl:"views/issuse.html",controller:"IssuseCtrl",controllerAs:"issuse"}).when("/:user/:repo/:page/:perPage",{templateUrl:"views/repo.html",controller:"RepoCtrl",controllerAs:"repo"}).when("/:user/:repo",{redirectTo:"/:user/:repo/1/5"}).otherwise({redirectTo:"/"})}]),angular.module("csssrApp").controller("MainCtrl",["$scope","$routeParams","$location","github",function(a,b,c,d){var e=d;a.page=e.page,a.pageSizes=[5,15,25,40,70,100],a.user=b.user,a.inputChanged=function(b){a.valInput=b},a.selectObject=function(b){a.valInput=b.description.full_name,a.search()},a.localSearch=function(b){var c=[];return a.page.repos.forEach(function(a){a.full_name.toLowerCase().indexOf(b.toString().toLowerCase())>=0&&c.push(a)}),c},a.search=function(b){c.path("/"+a.valInput+"/")},a.closeAlert=function(b){a.page.errors.splice(b,1)},angular.isDefined(a.user)&&e.getRepos(a.user)}]),angular.module("csssrApp").controller("IssuseCtrl",["$scope","$http","$routeParams","$rootScope","github",function(a,b,c,d,e){var f=e;a.page=f.page,f.getIssue(c.user,c.repo,c.id)}]),angular.module("csssrApp").factory("github",["$http",function(a){var b="https://api.github.com",c="2a05480ae29fc150d";c+="795b649dcb98a3b7feb1ab8";var d={total:0,data:[],repos:[],errors:[]},e=function(a){d.data=a},f=function(a){e(a.data);var b=a.headers("link");if(b){var c=b.match(/page=(\d){1,}&/g);d.total=c[1].match(/(\d){1,}/gi)}};return{page:d,getIssue:function(f,g,h){return a({method:"GET",url:b+"/repos/"+f+"/"+g+"/issues/"+h,params:{access_token:c}}).then(function(a){e(a.data)})["catch"](function(a){d.errors.push(data),console.error(a)})},getIssues:function(e,g,h,i){return a({method:"GET",url:b+"/repos/"+e+"/"+g+"/issues",params:{per_page:i,page:h,access_token:c}}).then(function(a){f(a)})["catch"](function(a){d.errors.push(a),console.error(a)})},getRepos:function(e){var f=e.match(/^([a-zA-Z\d_-]*)\/?$/gi);return a({method:"GET",url:b+"/users/"+f[0]+"/repos",params:{access_token:c,limit:500}}).then(function(a){a.data.map(function(a){d.repos.push({full_name:a.full_name})})})["catch"](function(a){d.errors.push(a),console.error(a)})}}}]),angular.module("csssrApp").filter("range",function(){return function(a,b){b=parseInt(b);for(var c=0;b>c;c++)a.push(c);return a}}),angular.module("csssrApp").directive("issue",function(){return{template:"<div></div>",restrict:"E",link:function(a,b,c){b.text("this is the issue directive")}}}),angular.module("csssrApp").component("user",{bindings:{item:"<"},template:'<div>автор:          |<a ng-href="{{$ctrl.item.html_url}}" role="button" class="btn btn-default">          |   <img ng-src="{{$ctrl.item.avatar_url}}"  width="30">{{$ctrl.item.login}}          |</a>        |</div>'}),angular.module("csssrApp").controller("RepoCtrl",["$scope","$routeParams","$location","github",function(a,b,c,d){var e=d;a.page=e.page,a.user=b.user,a.rep=b.repo,a.currentPage=b.page,a.perPage=b.perPage,e.getIssues(a.user,a.rep,a.currentPage,a.perPage)}]),angular.module("csssrApp").run(["$templateCache",function(a){a.put("views/issuse.html",'<div class="panel panel-default"> <div class="panel-heading"> <h3 class="panel-title"> {{page.data.title}} </h3> </div> <div class="panel-body" marked="page.data.body"> </div> <div class="panel-footer"> <div class=""> <a ng-href="{{page.data.user.html_url}}"> <img src="{{page.data.user.avatar_url}}" alt="" class="img-responsive img-circle" width="30"> {{page.data.user.login}} </a> <div class="pull-right"> {{page.data.created_at}} </div> </div> </div> </div>'),a.put("views/main.html",'<div class="jumbotron"> <h1>Hello, world!</h1> <p> <i class="fa-github-square fa fa-3x pull-left"></i> github issuse search </p> </div>'),a.put("views/repo.html",'<h2> {{user}}/{{rep}} <a ng-href="https://github.com/{{user}}/{{rep}}"> <i class="fa-external-link fa"></i> </a> </h2> <nav aria-label="Page navigation"> <div class="container"> <div class="row"> <div class="col-sm-6"> страницы: <ul class="pagination"> <li ng-repeat="page in []| range: page.total[0]"> <a ng-href="#!/{{user}}/{{rep}}/{{$index+1}}/{{perPage}}">{{$index+1}}</a> </li> </ul> </div> <div class="col-sm-6"> записей на странице <ul class="pagination"> <li ng-repeat="size in pageSizes"> <a ng-href="#!/{{user}}/{{rep}}/{{currentPage}}/{{size}}">{{size}}</a> </li> </ul> </div> </div> </div> </nav> <ul class="list-group"> <li class="list-group-item clearfix" ng-repeat="item in page.data"> <a ng-href="#!/{{user}}/{{rep}}/issuse/{{item.number}}"> <div class="list-group-item-heading"> #{{item.number}} дата создания: {{item.created_at}} <h3> {{item.title}} </h3> </div> </a> <div class="list-group-item-text" marked="item.body"> </div> <div class="list-group-item-footer"> <user item="item.user"> </user> </div> </li> </ul>')}]);